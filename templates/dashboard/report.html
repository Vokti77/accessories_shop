{% extends "base.html" %}
{% load mathfilters %}
{% load i18n %}
{% load static %}

{% block extra_css %}
    <style xmlns="http://www.w3.org/1999/html">
    </style>
{% endblock %}
{% block page_title %}
 Product Table
{% endblock %}
{% load crispy_forms_tags %}
{% block content %}

<div class="page-breadcrumb">
    <div class="row">
        <div class="col-12 d-flex no-block align-items-center">
            <h4 class="page-title">Report</h4>
            <div class="ml-auto text-right">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'dashboard:dashboard' %}">Home</a></li> 
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</div>
<form method="POST" id="example-form" action="{% url 'dashboard:report' %}" class="m-t-40" novalidate="novalidate">
    {% csrf_token %}
    From Date : <input type="date" name="from_date">
    To Date : <input type="date" name="to_date"> 
    <input type="submit" value="Search">
</form>
<br>
<form method="POST" id="example-form" action="{% url 'dashboard:report' %}" novalidate="novalidate">
    {% csrf_token %}
    <div class="d-flex "  >
        Select  :<select name="month" >
        <option value="">Select A Month </option>
        <option value="01" {% if current_month == 1 %}selected{% endif %}>January</option>
        <option value="02" {% if current_month == 2 %}selected{% endif %}>February</option>
        <option value="03" {% if current_month == 3 %}selected{% endif %}>March</option>
        <option value="04" {% if current_month == 4 %}selected{% endif %}>April</option>
        <option value="05" {% if current_month == 5 %}selected{% endif %}>May</option>
        <option value="06" {% if current_month == 6 %}selected{% endif %}>June</option>
        <option value="07" {% if current_month == 7 %}selected{% endif %}>July</option>
        <option value="08" {% if current_month == 8 %}selected{% endif %}>August</option>
        <option value="09" {% if current_month == 9 %}selected{% endif %}>September</option>
        <option value="10" {% if current_month == 10 %}selected{% endif %}>October</option>
        <option value="11" {% if current_month == 11 %}selected{% endif %}>November</option>
        <option value="12" {% if current_month == 12 %}selected{% endif %}>December</option>
    </select>
    <!-- <p type="text" name="year" placeholder="Year" value="{{ year }}" >
        {% now 'Y' %}
    </p> -->
    <input type="submit" value="Search">
    </div>
</form>

<script>
    document.getElementById("search_by").addEventListener("change", function() {
        var selectedOption = this.value;
        if (selectedOption === "date") {
            document.getElementById("example-form").action = "{% url 'dashboard:report' %}";
        } else if (selectedOption === "month") {
            document.getElementById("example-form").action = "{% url 'dashboard:report' %}";
        }
    });
</script>
<!-- In this example, we added a select element with two options: "Search by Date" and "Search by Month". We also added an event listener to the select element to update the action attribute of the form based on the selected option. When the user selects "Search by Date", the action attribute is set to the URL of the "date_search" view. When the user selects "Search by Month", the action attribute is set to the URL of the "month_search" view. -->




<div class="card">
<div class="card">
<div class="card-body">
   <div class="table-responsive">
        <div class="table-responsive">
            <table id="zero_config" class="table table-striped table-bordered">
                <thead style="background-color: #1F262D; color: antiquewhite;">
                <tr>
                    <th>Name</th>
                    <th>Brand</th>
                    <th>Quantity</th>
                    <th>Buy Price</th>
                    <th>Sale Price</th>
                    <th>Sale Quantity</th>
                    <th>Total Sale Amount</th>
                    <th>Total Profit</th>
                    <td>Date</td> 
                </tr>
            </thead>
            <tbody>
                {% for quantity in queryset %}
                <tr>
                    <td>{{ quantity.product.product_name }}</td>
                    <td>{{ quantity.product.model.brand.name }}</td>
                    <td>{{ quantity.product.product_quantity }}</td>
                    <td>{{ quantity.product.buying_price }}</td>
                    <td>{{ quantity.product.expecting_Saleing_price }}</td>
                    <td>{{ quantity.sale_quantity }}</td>
                    <td>{{ quantity.total_Sale_price }}</td>
                    <td>{{ quantity.total_Sale_price|sub:quantity.product.remining_quantity}}</td> 
                    <td>{{ quantity.sale_at}}</td>   
                </tr>
                {% endfor %}   
            </tbody>
            <tfoot style="background-color: rgb(221, 215, 215); font-family: garamond; ">
                <tr>
                    <th>Total = </th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th>{{ total_buying_price }}</th>
                    <th>{{ total_amount }}</th>
                    <th>{{ total_profit }}</th>
                    <th></th>
                </tr>
            </tfoot> 
        </table>
        <div class="col-md-12">
            {% if products.has_other_pages %}
          <ul class="pagination">
                {% if products.has_previous %}
                    <li class="page-item">
                      <a class="page-link" href="?page={{ products.previous_page_number }}">&laquo;</a>
                    </li>
                {% else %}
                    <li class="page-item disabled">
                      <a class="page-link">&laquo;</a>
                    </li>
                {% endif %}
            {% for i in products.paginator.page_range %}
                {% if listing_list.number == i %}
                <li class="page-item active">
                  <a class="page-link">{{ i }}</a>
                </li>
                {% else %}
                <li class="page-item">
                  <a class="page-link" href="?page={{ i }}">{{ i }}</a>
                </li>
                {% endif %}
            {% endfor %}
                {% if products.has_next %}
                    <li class="page-item">
                      <a class="page-link" href="?page={{ products.next_page_number }}">&raquo;</a>
                    </li>
                {% else %}
                    <li class="page-item disabled">
                      <a class="page-link">&laquo;</a>
                    </li>
                {% endif %}
          </ul>
          {% endif %}
        </div>
        </div>
    </div>
</div>
{% endblock %}

